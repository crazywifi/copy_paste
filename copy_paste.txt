import re

# Read the Nmap output file
with open("ssl_scan_results.txt", "r") as file:
    lines = file.readlines()

ip, port = None, None
for line in lines:
    # Capture IP address
    ip_match = re.search(r"Nmap scan report for (\d+\.\d+\.\d+\.\d+)", line)
    if ip_match:
        ip = ip_match.group(1)

    # Capture Port number
    port_match = re.search(r"(\d+)/open", line)
    if port_match:
        port = port_match.group(1)

    # Capture SSL certificate issues
    if "self-signed" in line or "not trusted" in line:
        print(f"{ip}:{port} - {line.strip()}")
